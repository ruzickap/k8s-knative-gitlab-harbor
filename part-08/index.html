<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Automated deployment with Tekton | Kubernetes + Knative + GitLab + Harbor</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="https://raw.githubusercontent.com/kubernetes/kubernetes/d9a58a39b69a0eaec5797e0f7a0f9472b4829ab0/logo/logo.svg">
    <meta name="description" content="Kubernetes + Knative + GitLab + Harbor">
    
    <link rel="preload" href="/k8s-knative-gitlab-harbor/assets/css/0.styles.985b6b59.css" as="style"><link rel="preload" href="/k8s-knative-gitlab-harbor/assets/js/app.e9f46d57.js" as="script"><link rel="preload" href="/k8s-knative-gitlab-harbor/assets/js/2.99da59a7.js" as="script"><link rel="preload" href="/k8s-knative-gitlab-harbor/assets/js/1.416be298.js" as="script"><link rel="preload" href="/k8s-knative-gitlab-harbor/assets/js/22.8f730d8b.js" as="script"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/10.f496eaac.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/11.6724c971.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/12.7aed55d0.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/13.050c5350.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/14.30343ebc.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/15.d3972987.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/16.cd753f26.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/17.6cd3a12a.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/18.8d7e6487.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/19.78b16bd4.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/20.a3f134b4.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/21.66c4eb78.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/23.1d6373ca.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/24.c43ab997.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/25.4bb64d24.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/26.a5905c70.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/27.2df1edf6.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/28.8647f919.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/29.36e9fab6.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/3.6b4152e0.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/30.f81551c9.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/31.aa5de726.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/32.22ccabcf.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/4.1a6ad45d.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/5.4b4e299e.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/6.88072c68.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/7.f09a9532.js"><link rel="prefetch" href="/k8s-knative-gitlab-harbor/assets/js/vendors~docsearch.857e8e87.js">
    <link rel="stylesheet" href="/k8s-knative-gitlab-harbor/assets/css/0.styles.985b6b59.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/k8s-knative-gitlab-harbor/" class="home-link router-link-active"><img src="https://raw.githubusercontent.com/kubernetes/kubernetes/d9a58a39b69a0eaec5797e0f7a0f9472b4829ab0/logo/logo.svg" alt="Kubernetes + Knative + GitLab + Harbor" class="logo"> <span class="site-name can-hide">Kubernetes + Knative + GitLab + Harbor</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/k8s-knative-gitlab-harbor/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Links" class="dropdown-title"><span class="title">Links</span> <span class="arrow down"></span></button> <button type="button" aria-label="Links" class="mobile-dropdown-title"><span class="title">Links</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitlab.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://goharbor.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Harbor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://cloud.google.com/knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Knative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/ruzickap/k8s-knative-gitlab-harbor" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/k8s-knative-gitlab-harbor/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Links" class="dropdown-title"><span class="title">Links</span> <span class="arrow down"></span></button> <button type="button" aria-label="Links" class="mobile-dropdown-title"><span class="title">Links</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitlab.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitLab
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://goharbor.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Harbor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://cloud.google.com/knative" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Knative
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/ruzickap/k8s-knative-gitlab-harbor" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/k8s-knative-gitlab-harbor/" aria-current="page" class="sidebar-link">Kubernetes + Knative + GitLab + Harbor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/#requirements" class="sidebar-link">Requirements</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/#content" class="sidebar-link">Content</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/#asciinema" class="sidebar-link">Asciinema</a></li></ul></li><li><a href="/k8s-knative-gitlab-harbor/part-01/" class="sidebar-link">Create k8s cluster</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-01/#prepare-the-local-working-environment" class="sidebar-link">Prepare the local working environment</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-01/#configure-aws" class="sidebar-link">Configure AWS</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-01/#create-k8s-in-aws" class="sidebar-link">Create K8s in AWS</a></li></ul></li><li><a href="/k8s-knative-gitlab-harbor/part-02/" class="sidebar-link">Install Helm</a></li><li><a href="/k8s-knative-gitlab-harbor/part-03/" class="sidebar-link">Istio + Knative + cert-manager + kubed installation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-03/#install-cert-manager" class="sidebar-link">Install cert-manager</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-03/#generate-tls-certificate" class="sidebar-link">Generate TLS certificate</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-03/#install-kubed" class="sidebar-link">Install kubed</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-03/#install-istio" class="sidebar-link">Install Istio</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-03/#create-dns-records" class="sidebar-link">Create DNS records</a></li></ul></li><li><a href="/k8s-knative-gitlab-harbor/part-04/" class="sidebar-link">Install Harbor</a></li><li><a href="/k8s-knative-gitlab-harbor/part-05/" class="sidebar-link">Install GitLab</a></li><li><a href="/k8s-knative-gitlab-harbor/part-06/" class="sidebar-link">Install Knative</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-06/#enable-automatic-tls-certificate-provisioning-for-knative" class="sidebar-link">Enable automatic TLS certificate provisioning for Knative</a></li></ul></li><li><a href="/k8s-knative-gitlab-harbor/part-07/" class="sidebar-link">Build and run container image using Knative + Tekton</a></li><li><a href="/k8s-knative-gitlab-harbor/part-08/" aria-current="page" class="active sidebar-link">Automated deployment with Tekton</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-08/#fork-podinfo-application" class="sidebar-link">Fork podinfo application</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-08/#create-tekton-triggers-configuration" class="sidebar-link">Create Tekton Triggers configuration</a></li><li class="sidebar-sub-header"><a href="/k8s-knative-gitlab-harbor/part-08/#change-the-source-code-of-the-app" class="sidebar-link">Change the source code of the app</a></li></ul></li><li><a href="/k8s-knative-gitlab-harbor/part-09/" class="sidebar-link">Knative operations</a></li><li><a href="/k8s-knative-gitlab-harbor/part-10/" class="sidebar-link">Clean-up</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="automated-deployment-with-tekton"><a href="#automated-deployment-with-tekton" class="header-anchor">#</a> Automated deployment with Tekton</h1> <p>Take a real example <a href="https://github.com/stefanprodan/podinfo" target="_blank" rel="noopener noreferrer">Podinfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
application and create full pipeline for it...</p> <h2 id="fork-podinfo-application"><a href="#fork-podinfo-application" class="header-anchor">#</a> Fork podinfo application</h2> <p>Fork the <a href="https://github.com/stefanprodan/podinfo" target="_blank" rel="noopener noreferrer">Podinfo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> repository
<code>podinfo</code>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> tmp
hub clone <span class="token string">&quot;stefanprodan/podinfo&quot;</span>
hub <span class="token parameter variable">-C</span> <span class="token string">&quot;podinfo&quot;</span> fork
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>Cloning into 'podinfo'...
remote: Enumerating objects: 10, done.
remote: Counting objects: 100% (10/10), done.
remote: Compressing objects: 100% (10/10), done.
remote: Total 5266 (delta 0), reused 3 (delta 0), pack-reused 5256
Receiving objects: 100% (5266/5266), 9.52 MiB | 1.93 MiB/s, done.
Resolving deltas: 100% (2342/2342), done.
Updating ruzickap
From https://github.com/stefanprodan/podinfo
 * [new branch]      gh-pages   -&gt; ruzickap/gh-pages
 * [new branch]      master     -&gt; ruzickap/master
 * [new branch]      v0.x       -&gt; ruzickap/v0.x
 * [new branch]      v1.x       -&gt; ruzickap/v1.x
 * [new branch]      v3.x       -&gt; ruzickap/v3.x
new remote: ruzickap
</code></pre></div><h2 id="create-tekton-triggers-configuration"><a href="#create-tekton-triggers-configuration" class="header-anchor">#</a> Create Tekton Triggers configuration</h2> <p>Create new namespace:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create namespace getting-started
</code></pre></div><p>Create the admin user, role and rolebinding:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tekton-triggers-admin
  namespace: getting-started
rules:
- apiGroups:
  - tekton.dev
  resources:
  - eventlisteners
  - triggerbindings
  - triggertemplates
  - pipelineresources
  verbs:
  - get
- apiGroups:
  - tekton.dev
  resources:
  - pipelineruns
  - pipelineresources
  verbs:
  - create
- apiGroups:
  - &quot;&quot;
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - apps
  resources:
  - deployments
  verbs:
  - get
  - list
  - watch
  - create
  - patch
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tekton-triggers-admin
  namespace: getting-started
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: tekton-triggers-admin-binding
  namespace: getting-started
subjects:
  - kind: ServiceAccount
    name: tekton-triggers-admin
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tekton-triggers-admin
EOF</span>
</code></pre></div><p>Create the <code>create-webhook</code> user, role and rolebinding:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
kind: Role
apiVersion: rbac.authorization.k8s.io/v1
metadata:
  name: tekton-triggers-createwebhook
  namespace: getting-started
rules:
- apiGroups:
  - &quot;&quot;
  resources:
  - secrets
  verbs:
  - get
  - list
  - create
  - update
  - delete
- apiGroups:
  - tekton.dev
  resources:
  - eventlisteners
  verbs:
  - get
  - list
  - create
  - update
  - delete
- apiGroups:
  - networking.istio.io
  resources:
  - virtualservices
  - gateways
  verbs:
  - create
  - get
  - list
  - delete
  - update
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: tekton-triggers-createwebhook
  namespace: getting-started
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: tekton-triggers-createwebhook
  namespace: getting-started
subjects:
  - kind: ServiceAccount
    name: tekton-triggers-createwebhook
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: tekton-triggers-createwebhook
EOF</span>
</code></pre></div><p>Create secret for Harbor registry to let Tekton pipeline to upload the container
image:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create secret docker-registry <span class="token parameter variable">-n</span> getting-started harbor-docker-config <span class="token punctuation">\</span>
  --docker-server<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${CONTAINER_REGISTRY_SERVER}</span>&quot;</span> <span class="token punctuation">\</span>
  --docker-username<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${CONTAINER_REGISTRY_USERNAME}</span>&quot;</span> <span class="token punctuation">\</span>
  --docker-password<span class="token operator">=</span><span class="token string">&quot;<span class="token variable">${CONTAINER_REGISTRY_PASSWORD}</span>&quot;</span>
</code></pre></div><p>Install the Pipeline:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">\</span>EOF <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: build-docker-image-from-git-task
  namespace: getting-started
spec:
  inputs:
    resources:
      - name: docker-source
        type: <span class="token function">git</span>
    params:
      - name: pathToDockerFile
        description: The path to the dockerfile to build
        default: /workspace/docker-source/Dockerfile
      - name: pathToContext
        description:
          The build context used by Kaniko
          <span class="token punctuation">(</span>https://github.com/GoogleContainerTools/kaniko<span class="token comment">#kaniko-build-contexts)</span>
        default: /workspace/docker-source
  outputs:
    resources:
      - name: image-source
        type: image
  volumes:
    - name: docker-config
      secret:
        secretName: harbor-docker-config
        items:
          - key: .dockerconfigjson
            path: config.json
    - name: shared-storage
      emptyDir: <span class="token punctuation">{</span><span class="token punctuation">}</span>
  steps:
    - name: build
      image: gcr.io/kaniko-project/executor
      env:
        - name: <span class="token string">&quot;DOCKER_CONFIG&quot;</span>
          value: <span class="token string">&quot;/builder/home/.docker/&quot;</span>
      command:
        - /kaniko/executor
      args:
        - <span class="token parameter variable">--dockerfile</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>inputs.params.pathToDockerFile<span class="token variable">)</span></span>
        - <span class="token parameter variable">--destination</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>outputs.resources.image-source.url<span class="token variable">)</span></span>
        - <span class="token parameter variable">--context</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>inputs.params.pathToContext<span class="token variable">)</span></span>
        - --skip-tls-verify
      volumeMounts:
        - name: docker-config
          mountPath: /builder/home/.docker/
---
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: deploy-locally
  namespace: getting-started
spec:
  inputs:
    resources:
      - name: image-source
        type: image
  outputs:
    resources:
    - name: event-to-sink
      type: cloudEvent
  steps:
    - name: run-kubectl
      image: lachlanevenson/k8s-kubectl:latest
      command:
      - <span class="token function">sh</span>
      args:
      - <span class="token parameter variable">-ce</span>
      - <span class="token operator">|</span>
        <span class="token builtin class-name">set</span> <span class="token parameter variable">-ex</span>
        kubectl run podinfo <span class="token parameter variable">--image</span> <span class="token variable"><span class="token variable">$(</span>inputs.resources.image-source.url<span class="token variable">)</span></span> <span class="token parameter variable">-o</span> yaml --dry-run <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -
---
apiVersion: tekton.dev/v1alpha1
kind: Pipeline
metadata:
  name: getting-started-pipeline
  namespace: getting-started
spec:
  resources:
  - name: docker-source
    type: <span class="token function">git</span>
  - name: image-source
    type: image
  - name: event-to-sink
    type: cloudEvent
  tasks:
    - name: build-docker-image-from-git-task-run
      taskRef:
        name: build-docker-image-from-git-task
      params:
      - name: pathToDockerFile
        value: Dockerfile
      - name: pathToContext
        value: /workspace/docker-source/
      resources:
        inputs:
        - name: docker-source
          resource: docker-source
        outputs:
        - name: image-source
          resource: image-source
    - name: deploy-locally
      taskRef:
        name: deploy-locally
      resources:
        inputs:
          - name: image-source
            resource: image-source
            from:
              - build-docker-image-from-git-task-run
        outputs:
          - name: event-to-sink
            resource: event-to-sink
---
apiVersion: v1
kind: Service
metadata:
  name: event-display
  namespace: getting-started
  labels:
    app: event-display
spec:
  type: ClusterIP
  ports:
    - name: listener
      port: <span class="token number">8080</span>
      protocol: TCP
  selector:
    app: event-display
---
  apiVersion: v1
  kind: Pod
  metadata:
    name: event-display
    namespace: getting-started
    labels:
      name: event-display
  spec:
    hostname: event-display
    containers:
    - image: gcr.io/knative-releases/github.com/knative/eventing-sources/cmd/event_display
      name: web
EOF
</code></pre></div><p>Install the TriggerTemplate, TriggerBinding and EventListener:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: tekton.dev/v1alpha1
kind: TriggerTemplate
metadata:
  name: getting-started-triggertemplate
  namespace: getting-started
spec:
  params:
    - name: gitrevision
      description: The git revision
      default: master
    - name: gitrepositoryurl
      description: The git repository url
    - name: image_registry_url
      description: The container registry url
    - name: namespace
      description: The namespace to create the resources
  resourcetemplates:
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineResource
      metadata:
        name: source-repo-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
        namespace: \<span class="token variable"><span class="token variable">$(</span>params.namespace<span class="token variable">)</span></span>
      spec:
        type: git
        params:
        - name: revision
          value: \<span class="token variable"><span class="token variable">$(</span>params.gitrevision<span class="token variable">)</span></span>
        - name: url
          value: \<span class="token variable"><span class="token variable">$(</span>params.gitrepositoryurl<span class="token variable">)</span></span>
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineResource
      metadata:
        name: image-source-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
        namespace: \<span class="token variable"><span class="token variable">$(</span>params.namespace<span class="token variable">)</span></span>
      spec:
        type: image
        params:
          - name: url
            value: \<span class="token variable"><span class="token variable">$(</span>params.image_registry_url<span class="token variable">)</span></span>
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineResource
      metadata:
        name: event-to-sink-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
        namespace: \<span class="token variable"><span class="token variable">$(</span>params.namespace<span class="token variable">)</span></span>
      spec:
        type: cloudEvent
        params:
          - name: targetURI
            value: http://event-display.getting-started.svc.cluster.local
    - apiVersion: tekton.dev/v1alpha1
      kind: PipelineRun
      metadata:
        name: getting-started-pipeline-run-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
        namespace: \<span class="token variable"><span class="token variable">$(</span>params.namespace<span class="token variable">)</span></span>
      spec:
        serviceAccount: tekton-triggers-admin
        pipelineRef:
          name: getting-started-pipeline
        resources:
          - name: docker-source
            resourceRef:
              name: source-repo-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
          - name: image-source
            resourceRef:
              name: image-source-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
          - name: event-to-sink
            resourceRef:
              name: event-to-sink-\<span class="token variable"><span class="token variable">$(</span>uid<span class="token variable">)</span></span>
---
apiVersion: tekton.dev/v1alpha1
kind: TriggerBinding
metadata:
  name: getting-started-pipelinebinding
  namespace: getting-started
spec:
  params:
    - name: gitrevision
      value: \<span class="token variable"><span class="token variable">$(</span>body.head_commit.id<span class="token variable">)</span></span>
    - name: namespace
      value: getting-started
    - name: gitrepositoryurl
      value: &quot;https://github.com/\<span class="token variable"><span class="token variable">$(</span>body.repository.full_name<span class="token variable">)</span></span>&quot;
    - name: image_registry_url
      value: &quot;harbor.<span class="token variable">${MY_DOMAIN}</span>/library/\<span class="token variable"><span class="token variable">$(</span>body.repository.name<span class="token variable">)</span></span>&quot;
---
apiVersion: tekton.dev/v1alpha1
kind: EventListener
metadata:
  name: getting-started-listener
  namespace: getting-started
spec:
  serviceAccountName: tekton-triggers-admin
  triggers:
    - binding:
        name: getting-started-pipelinebinding
      template:
        name: getting-started-triggertemplate
EOF</span>
</code></pre></div><h3 id="configure-webhook"><a href="#configure-webhook" class="header-anchor">#</a> Configure webhook</h3> <p>Create Task which will create Istio Gateway and VirtualService to handle
incoming webhook form GitHub:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">\</span>EOF2 <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: create-istio-gateway-virtualservice
  namespace: getting-started
spec:
  volumes:
  - name: work
    emptyDir: <span class="token punctuation">{</span><span class="token punctuation">}</span>

  inputs:
    params:
    - name: TLScredentialName
      description: <span class="token string">&quot;Specify the secret with wildcard certificate&quot;</span>
    - name: ExternalDomain
      description: <span class="token string">&quot;The external domain for the EventListener&quot;</span>
    - name: Service
      description: <span class="token string">&quot;The name of the Service used in the VirtualService&quot;</span>
    - name: ServicePort
      description: <span class="token string">&quot;The service port that the VirtualService is being created on&quot;</span>

  steps:
  - name: create-istio-gateway-virtualservice
    image: lachlanevenson/k8s-kubectl:latest
    command:
    - <span class="token function">sh</span>
    args:
    - <span class="token parameter variable">-ce</span>
    - <span class="token operator">|</span>
      <span class="token builtin class-name">set</span> <span class="token parameter variable">-ex</span>
      <span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl create <span class="token parameter variable">-f</span> -</span>
      apiVersion: networking.istio.io/v1alpha3
      kind: Gateway
      metadata:
        name: <span class="token variable"><span class="token variable">$(</span>inputs.params.Service<span class="token variable">)</span></span>-gateway
      spec:
        selector:
          istio: ingressgateway
        servers:
        - port:
            number: 443
            name: https-<span class="token variable"><span class="token variable">$(</span>inputs.params.Service<span class="token variable">)</span></span>
            protocol: HTTPS
          hosts:
          - <span class="token variable"><span class="token variable">$(</span>inputs.params.ExternalDomain<span class="token variable">)</span></span>
          tls:
            credentialName: <span class="token variable"><span class="token variable">$(</span>inputs.params.TLScredentialName<span class="token variable">)</span></span>
            mode: SIMPLE
            privateKey: sds
            serverCertificate: sds
      ---
      apiVersion: networking.istio.io/v1alpha3
      kind: VirtualService
      metadata:
        name: <span class="token variable"><span class="token variable">$(</span>inputs.params.Service<span class="token variable">)</span></span>-virtual-service
      spec:
        hosts:
        - <span class="token variable"><span class="token variable">$(</span>inputs.params.ExternalDomain<span class="token variable">)</span></span>
        gateways:
        - <span class="token variable"><span class="token variable">$(</span>inputs.params.Service<span class="token variable">)</span></span>-gateway
        http:
        - route:
          - destination:
              host: <span class="token variable"><span class="token variable">$(</span>inputs.params.Service<span class="token variable">)</span></span>
              port:
                number: <span class="token variable"><span class="token variable">$(</span>inputs.params.ServicePort<span class="token variable">)</span></span>
      EOF
EOF</span><span class="token number">2</span>
</code></pre></div><p>Create TaskRun to start <code>create-istio-gateway-virtualservice</code> Task:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: create-istio-gateway-virtualservice-run
  namespace: getting-started
spec:
  taskRef:
    name: create-istio-gateway-virtualservice
  inputs:
    params:
    - name: TLScredentialName
      value: ingress-cert-<span class="token variable">${LETSENCRYPT_ENVIRONMENT}</span>
    - name: ExternalDomain
      value: getting-started.<span class="token variable">${MY_DOMAIN}</span>
    - name: Service
      value: el-getting-started-listener
    - name: ServicePort
      value: &quot;8080&quot;
  timeout: 1000s
  serviceAccount: tekton-triggers-createwebhook
EOF</span>
</code></pre></div><p>Create webhook Task:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">\</span>EOF <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -
apiVersion: tekton.dev/v1alpha1
kind: Task
metadata:
  name: create-webhook
  namespace: getting-started
spec:
  volumes:
  - name: github-secret
    secret:
      secretName: <span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubSecretName<span class="token variable">)</span></span>

  inputs:
    params:
    - name: ExternalDomain
      description: <span class="token string">&quot;The external domain for the EventListener e.g. <span class="token variable"><span class="token variable">`</span><span class="token variable">$(</span>inputs.params.EventListenerName<span class="token punctuation">)</span>.<span class="token operator">&lt;</span>PROXYIP<span class="token operator">&gt;</span>.nip.io<span class="token variable">`</span></span>&quot;</span>
    - name: GitHubUser
      description: <span class="token string">&quot;The GitHub user&quot;</span>
    - name: GitHubRepo
      description: <span class="token string">&quot;The GitHub repo where the webhook will be created&quot;</span>
    - name: GitHubOrg
      description: <span class="token string">&quot;The GitHub organization where the webhook will be created&quot;</span>
    - name: GitHubSecretName
      description: <span class="token string">&quot;The Secret name for GitHub access token. This is always mounted and must exist&quot;</span>
    - name: GitHubAccessTokenKey
      description: <span class="token string">&quot;The GitHub access token key name&quot;</span>
    - name: GitHubSecretStringKey
      description: <span class="token string">&quot;The GitHub secret string key name&quot;</span>
    - name: GitHubDomain
      description: <span class="token string">&quot;The GitHub domain. Override for GitHub Enterprise&quot;</span>
      default: <span class="token string">&quot;github.com&quot;</span>
    - name: WebhookEvents
      description: <span class="token string">&quot;List of events the webhook will send notifications for&quot;</span>
      default: <span class="token string">&quot;[<span class="token entity" title="\\">\\</span><span class="token entity" title="\&quot;">\&quot;</span>push<span class="token entity" title="\\">\\</span><span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\\">\\</span><span class="token entity" title="\&quot;">\&quot;</span>pull_request<span class="token entity" title="\\">\\</span><span class="token entity" title="\&quot;">\&quot;</span>]&quot;</span>

  steps:
  - name: create-webhook
    image: pstauffer/curl:latest
    volumeMounts:
    - name: github-secret
      mountPath: /var/secret
    command:
    - <span class="token function">sh</span>
    args:
    - <span class="token parameter variable">-ce</span>
    - <span class="token operator">|</span>
      <span class="token builtin class-name">set</span> <span class="token parameter variable">-e</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;Create Webhook&quot;</span>
      <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubDomain<span class="token variable">)</span></span> <span class="token operator">=</span> <span class="token string">&quot;github.com&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
        <span class="token function">curl</span> <span class="token parameter variable">-v</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>web<span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>active<span class="token entity" title="\&quot;">\&quot;</span>: true,<span class="token entity" title="\&quot;">\&quot;</span>events<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token variable"><span class="token variable">$(</span>inputs.params.WebhookEvents<span class="token variable">)</span></span>,<span class="token entity" title="\&quot;">\&quot;</span>config<span class="token entity" title="\&quot;">\&quot;</span>: {<span class="token entity" title="\&quot;">\&quot;</span>url<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>https://<span class="token variable"><span class="token variable">$(</span>inputs.params.ExternalDomain<span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>content_type<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>json<span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>insecure_ssl<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1<span class="token entity" title="\&quot;">\&quot;</span> ,<span class="token entity" title="\&quot;">\&quot;</span>secret<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /var/secret/<span class="token punctuation">$(</span>inputs.params.GitHubSecretStringKey<span class="token punctuation">)</span><span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>}}&quot;</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-u</span> <span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubUser<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /var/secret/<span class="token punctuation">$(</span>inputs.params.GitHubAccessTokenKey<span class="token punctuation">)</span><span class="token variable">)</span></span> <span class="token parameter variable">-L</span> https://api.github.com/repos/<span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubOrg<span class="token variable">)</span></span>/<span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubRepo<span class="token variable">)</span></span>/hooks
      <span class="token keyword">else</span>
        <span class="token function">curl</span> <span class="token parameter variable">-d</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>web<span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>active<span class="token entity" title="\&quot;">\&quot;</span>: true,<span class="token entity" title="\&quot;">\&quot;</span>events<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token variable"><span class="token variable">$(</span>inputs.params.WebhookEvents<span class="token variable">)</span></span>,<span class="token entity" title="\&quot;">\&quot;</span>config<span class="token entity" title="\&quot;">\&quot;</span>: {<span class="token entity" title="\&quot;">\&quot;</span>url<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>https://<span class="token variable"><span class="token variable">$(</span>inputs.params.ExternalDomain<span class="token variable">)</span></span>/<span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>content_type<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>json<span class="token entity" title="\&quot;">\&quot;</span>,<span class="token entity" title="\&quot;">\&quot;</span>insecure_ssl<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1<span class="token entity" title="\&quot;">\&quot;</span> ,<span class="token entity" title="\&quot;">\&quot;</span>secret<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /var/secret/<span class="token punctuation">$(</span>inputs.params.GitHubSecretStringKey<span class="token punctuation">)</span><span class="token variable">)</span></span><span class="token entity" title="\&quot;">\&quot;</span>}}&quot;</span> <span class="token parameter variable">-X</span> POST <span class="token parameter variable">-u</span> <span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubUser<span class="token variable">)</span></span><span class="token builtin class-name">:</span><span class="token variable"><span class="token variable">$(</span><span class="token function">cat</span> /var/secret/<span class="token punctuation">$(</span>inputs.params.GitHubAccessTokenKey<span class="token punctuation">)</span><span class="token variable">)</span></span> <span class="token parameter variable">-L</span> https://<span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubDomain<span class="token variable">)</span></span>/api/v3/repos/<span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubOrg<span class="token variable">)</span></span>/<span class="token variable"><span class="token variable">$(</span>inputs.params.GitHubRepo<span class="token variable">)</span></span>/hooks
      <span class="token keyword">fi</span>
EOF
</code></pre></div><p>Create secret with <a href="https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token" target="_blank" rel="noopener noreferrer">GitHub Personal Access Token<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: v1
kind: Secret
metadata:
  name: webhook-secret
  namespace: getting-started
stringData:
  token: <span class="token variable">${GITHUB_TOKEN}</span>
  secret: random-string-data
EOF</span>
</code></pre></div><p>Create TaskRun to initiate Webhook:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sleep</span> <span class="token number">20</span> <span class="token comment"># Wait for DNS created by previous TaskRun</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span> <span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> kubectl apply <span class="token parameter variable">-f</span> -</span>
apiVersion: tekton.dev/v1alpha1
kind: TaskRun
metadata:
  name: create-webhook-run
  namespace: getting-started
spec:
  taskRef:
    name: create-webhook
  inputs:
    params:
    - name: GitHubOrg
      value: &quot;ruzickap&quot;
    - name: GitHubUser
      value: &quot;ruzickap&quot;
    - name: GitHubRepo
      value: &quot;podinfo&quot;
    - name: GitHubSecretName
      value: webhook-secret
    - name: GitHubAccessTokenKey
      value: token
    - name: GitHubSecretStringKey
      value: secret
    - name: ExternalDomain
      value: getting-started.<span class="token variable">${MY_DOMAIN}</span>
  timeout: 1000s
  serviceAccount: tekton-triggers-createwebhook
EOF</span>
<span class="token function">sleep</span> <span class="token number">5</span>
</code></pre></div><p>Verify if the TaskRuns were successfully executed:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get taskruns.tekton.dev <span class="token parameter variable">-n</span> getting-started
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>NAME                                      SUCCEEDED   REASON      STARTTIME   COMPLETIONTIME
create-istio-gateway-virtualservice-run   True        Succeeded   80s         71s
create-webhook-run                        Unknown     Pending     2s
</code></pre></div><p>Look at the logs from <code>create-istio-gateway-virtualservice</code> TaskRun:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tkn taskrun logs <span class="token parameter variable">-n</span> getting-started create-istio-gateway-virtualservice-run
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>[create-istio-gateway-virtualservice] + + kubectl create -f -
[create-istio-gateway-virtualservice] cat
[create-istio-gateway-virtualservice] gateway.networking.istio.io/el-getting-started-listener-gateway created
[create-istio-gateway-virtualservice] virtualservice.networking.istio.io/el-getting-started-listener-virtual-service created
</code></pre></div><p>Look at the logs from <code>create-webhook-run</code> TaskRun:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>tkn taskrun logs <span class="token parameter variable">-n</span> getting-started create-webhook-run
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>[create-webhook] Create Webhook
[create-webhook] Note: Unnecessary use of -X or --request, POST is already inferred.
[create-webhook]   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
[create-webhook]                                  Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 140.82.118.6...
[create-webhook] * TCP_NODELAY set
[create-webhook] * Connected to api.github.com (140.82.118.6) port 443 (#0)
[create-webhook] * ALPN, offering h2
[create-webhook] * ALPN, offering http/1.1
[create-webhook] * successfully set certificate verify locations:
[create-webhook] *   CAfile: /etc/ssl/certs/ca-certificates.crt
[create-webhook]   CApath: none
[create-webhook] * TLSv1.2 (OUT), TLS handshake, Client hello (1):
[create-webhook] } [232 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS handshake, Server hello (2):
[create-webhook] { [108 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS handshake, Certificate (11):
[create-webhook] { [2851 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS handshake, Server key exchange (12):
[create-webhook] { [300 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS handshake, Server finished (14):
[create-webhook] { [4 bytes data]
[create-webhook] * TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
[create-webhook] } [37 bytes data]
[create-webhook] * TLSv1.2 (OUT), TLS change cipher, Client hello (1):
[create-webhook] } [1 bytes data]
[create-webhook] * TLSv1.2 (OUT), TLS handshake, Finished (20):
[create-webhook] } [16 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS change cipher, Client hello (1):
[create-webhook] { [1 bytes data]
[create-webhook] * TLSv1.2 (IN), TLS handshake, Finished (20):
[create-webhook] { [16 bytes data]
[create-webhook] * SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256
[create-webhook] * ALPN, server accepted to use http/1.1
[create-webhook] * Server certificate:
[create-webhook] *  subject: C=US; ST=California; L=San Francisco; O=GitHub, Inc.; CN=*.github.com
[create-webhook] *  start date: Jul  8 00:00:00 2019 GMT
[create-webhook] *  expire date: Jul 16 12:00:00 2020 GMT
[create-webhook] *  subjectAltName: host &quot;api.github.com&quot; matched cert's &quot;*.github.com&quot;
[create-webhook] *  issuer: C=US; O=DigiCert Inc; OU=www.digicert.com; CN=DigiCert SHA2 High Assurance Server CA
[create-webhook] *  SSL certificate verify ok.
[create-webhook] * Server auth using Basic with user 'ruzickap'
[create-webhook] &gt; POST /repos/ruzickap/podinfo/hooks HTTP/1.1
[create-webhook] &gt; Host: api.github.com
[create-webhook] &gt; Authorization: Basic cnxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxU3MA==
[create-webhook] &gt; User-Agent: curl/7.60.0
[create-webhook] &gt; Accept: */*
[create-webhook] &gt; Content-Length: 195
[create-webhook] &gt; Content-Type: application/x-www-form-urlencoded
[create-webhook] &gt;
[create-webhook] } [195 bytes data]
[create-webhook] * upload completely sent off: 195 out of 195 bytes
[create-webhook] &amp;lt; HTTP/1.1 201 Created
[create-webhook] &amp;lt; Date: Fri, 27 Dec 2019 10:19:37 GMT
[create-webhook] &amp;lt; Content-Type: application/json; charset=utf-8
[create-webhook] &amp;lt; Content-Length: 688
[create-webhook] &amp;lt; Server: GitHub.com
[create-webhook] &amp;lt; Status: 201 Created
[create-webhook] &amp;lt; X-RateLimit-Limit: 5000
[create-webhook] &amp;lt; X-RateLimit-Remaining: 4992
[create-webhook] &amp;lt; X-RateLimit-Reset: 1577445296
[create-webhook] &amp;lt; Cache-Control: private, max-age=60, s-maxage=60
[create-webhook] &amp;lt; Vary: Accept, Authorization, Cookie, X-GitHub-OTP
[create-webhook] &amp;lt; ETag: &quot;a9xxxxxxxxxxxxxxxxxxxxxxxxxxxxe3&quot;
[create-webhook] &amp;lt; X-OAuth-Scopes: admin:org_hook, admin:repo_hook, delete_repo, read:org, repo, user:email
[create-webhook] &amp;lt; X-Accepted-OAuth-Scopes: admin:repo_hook, public_repo, repo, write:repo_hook
[create-webhook] &amp;lt; Location: https://api.github.com/repos/ruzickap/podinfo/hooks/170061618
[create-webhook] &amp;lt; X-GitHub-Media-Type: github.v3; format=json
[create-webhook] &amp;lt; Access-Control-Expose-Headers: ETag, Link, Location, Retry-After, X-GitHub-OTP, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset, X-OAuth-Scopes, X-Accepted-OAuth-Scopes, X-Poll-Interval, X-GitHub-Media-Type
[create-webhook] &amp;lt; Access-Control-Allow-Origin: *
[create-webhook] &amp;lt; Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
[create-webhook] &amp;lt; X-Frame-Options: deny
[create-webhook] &amp;lt; X-Content-Type-Options: nosniff
[create-webhook] &amp;lt; X-XSS-Protection: 1; mode=block
[create-webhook] &amp;lt; Referrer-Policy: origin-when-cross-origin, strict-origin-when-cross-origin
[create-webhook] &amp;lt; Content-Security-Policy: default-src 'none'
[create-webhook] &amp;lt; Vary: Accept-Encoding
[create-webhook] &amp;lt; X-GitHub-Request-Id: CEXX:XXXXX:XXXXXXX:XXXXXXX:XXXXXXB9
[create-webhook] &amp;lt;
[create-webhook] { [688 bytes data]
100   883  100   688  100   195   1746    494 --:--:-- --:--:-- --:--:--  2241
[create-webhook] * Connection #0 to host api.github.com left intact
[create-webhook] {
[create-webhook]   &quot;type&quot;: &quot;Repository&quot;,
[create-webhook]   &quot;id&quot;: 170061618,
[create-webhook]   &quot;name&quot;: &quot;web&quot;,
[create-webhook]   &quot;active&quot;: true,
[create-webhook]   &quot;events&quot;: [
[create-webhook]     &quot;pull_request&quot;,
[create-webhook]     &quot;push&quot;
[create-webhook]   ],
[create-webhook]   &quot;config&quot;: {
[create-webhook]     &quot;content_type&quot;: &quot;json&quot;,
[create-webhook]     &quot;insecure_ssl&quot;: &quot;1&quot;,
[create-webhook]     &quot;secret&quot;: &quot;********&quot;,
[create-webhook]     &quot;url&quot;: &quot;https://getting-started.mylabs.dev&quot;
[create-webhook]   },
[create-webhook]   &quot;updated_at&quot;: &quot;2019-12-27T10:19:37Z&quot;,
[create-webhook]   &quot;created_at&quot;: &quot;2019-12-27T10:19:37Z&quot;,
[create-webhook]   &quot;url&quot;: &quot;https://api.github.com/repos/ruzickap/podinfo/hooks/170061618&quot;,
[create-webhook]   &quot;test_url&quot;: &quot;https://api.github.com/repos/ruzickap/podinfo/hooks/170061618/test&quot;,
[create-webhook]   &quot;ping_url&quot;: &quot;https://api.github.com/repos/ruzickap/podinfo/hooks/170061618/pings&quot;,
[create-webhook]   &quot;last_response&quot;: {
[create-webhook]     &quot;code&quot;: null,
[create-webhook]     &quot;status&quot;: &quot;unused&quot;,
[create-webhook]     &quot;message&quot;: null
[create-webhook]   }
[create-webhook] }
</code></pre></div><p>You should also see in the GitHub / Settings / Webhook the registration <a href="https://github.com/ruzickap/podinfo/settings/hooks/" target="_blank" rel="noopener noreferrer">https://github.com/ruzickap/podinfo/settings/hooks/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>:</p> <p><img src="/k8s-knative-gitlab-harbor/assets/img/GitHub_Webhooks.3cdaed97.png" alt="GitHub Webhooks" title="GitHub Webhooks"></p> <p>After clicking on the Webhook you can see the details:</p> <p><img src="/k8s-knative-gitlab-harbor/assets/img/GitHub_Webhooks-Details.da577fc5.png" alt="GitHub Webhooks - Details" title="GitHub Webhooks - Details"></p> <p>In case you are troubleshooting the incoming traffic from GitHub the look at
the logs of the pod. You should be able to see the details
in the <code>kubectl logs</code>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get pods <span class="token parameter variable">-n</span> getting-started <span class="token parameter variable">-l</span> <span class="token assign-left variable">eventlistener</span><span class="token operator">=</span>getting-started-listener
<span class="token function">sleep</span> <span class="token number">5</span>
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>NAME                                          READY   STATUS    RESTARTS   AGE
el-getting-started-listener-fcffc467d-xwsfp   1/1     Running   0          2m6s
</code></pre></div><h2 id="change-the-source-code-of-the-app"><a href="#change-the-source-code-of-the-app" class="header-anchor">#</a> Change the source code of the app</h2> <p>Trigger the pipeline by calling the:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;Trigger build&quot;</span> <span class="token operator">&gt;&gt;</span> podinfo/README.md
<span class="token function">git</span> <span class="token parameter variable">-C</span> podinfo commit <span class="token parameter variable">-s</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-m</span> <span class="token string">&quot;Standard version&quot;</span>
<span class="token function">git</span> <span class="token parameter variable">-C</span> podinfo push ruzickap
<span class="token function">sleep</span> <span class="token number">30</span>
kubectl <span class="token parameter variable">--timeout</span><span class="token operator">=</span>10m <span class="token parameter variable">-n</span> getting-started <span class="token function">wait</span> <span class="token parameter variable">--for</span><span class="token operator">=</span>condition<span class="token operator">=</span>Succeeded pipelineruns <span class="token parameter variable">--all</span>
<span class="token function">sleep</span> <span class="token number">5</span>
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>[master d4120e6] Standard version
 1 file changed, 1 insertion(+), 1 deletion(-)
Warning: Permanently added '[ssh.github.com]:443,[192.30.253.122]:443' (RSA) to the list of known hosts.
Enumerating objects: 5, done.
Counting objects: 100% (5/5), done.
Delta compression using up to 4 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 325 bytes | 162.00 KiB/s, done.
Total 3 (delta 2), reused 0 (delta 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To github.com:ruzickap/podinfo.git
   948de81..d4120e6  master -&gt; master
pipelinerun.tekton.dev/getting-started-pipeline-run-fzrtg condition met
</code></pre></div><p>Look at the logs of the newly deployed pod (look at <code>&quot;Starting podinfo&quot;</code>):</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">PODINFO_POD</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl get pods <span class="token parameter variable">-n</span> getting-started <span class="token parameter variable">-l</span><span class="token operator">=</span>run<span class="token operator">=</span>podinfo <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span>
kubectl <span class="token parameter variable">-n</span> getting-started logs <span class="token parameter variable">-n</span> getting-started <span class="token variable">${PODINFO_POD}</span>
</code></pre></div><p>Output:</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token string">&quot;2019-11-27T15:00:58.907Z&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;caller&quot;</span><span class="token operator">:</span><span class="token string">&quot;podinfo/main.go:120&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;Starting podinfo&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token string">&quot;3.1.5&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;revision&quot;</span><span class="token operator">:</span><span class="token string">&quot;164a27b33b09d1b50fad277a60a6c19d353cb9d8&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token string">&quot;9898&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>Let's try to change the code of the application:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s/Starting podinfo/Starting podinfo - new Tekton build version/&quot;</span> podinfo/cmd/podinfo/main.go
<span class="token function">git</span> <span class="token parameter variable">-C</span> podinfo <span class="token function">diff</span>
<span class="token function">git</span> <span class="token parameter variable">-C</span> podinfo commit <span class="token parameter variable">-s</span> <span class="token parameter variable">-a</span> <span class="token parameter variable">-m</span> <span class="token string">&quot;String changed&quot;</span>
<span class="token function">git</span> <span class="token parameter variable">-C</span> podinfo push ruzickap
<span class="token function">sleep</span> <span class="token number">20</span>
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>
modified: cmd/podinfo/main.go

@ cmd/podinfo/main.go:120 @ func main() {
    }

    // log version and port
    logger.Info(&quot;Starting podinfo&quot;,
    logger.Info(&quot;Starting podinfo - new Tekton build version&quot;,
        zap.String(&quot;version&quot;, viper.GetString(&quot;version&quot;)),
        zap.String(&quot;revision&quot;, viper.GetString(&quot;revision&quot;)),
        zap.String(&quot;port&quot;, srvCfg.Port),
[master 4d9f5bc] String changed
 1 file changed, 1 insertion(+), 1 deletion(-)
Warning: Permanently added '[ssh.github.com]:443,[192.30.253.122]:443' (RSA) to the list of known hosts.
Enumerating objects: 9, done.
Counting objects: 100% (9/9), done.
Delta compression using up to 4 threads
Compressing objects: 100% (4/4), done.
Writing objects: 100% (5/5), 459 bytes | 459.00 KiB/s, done.
Total 5 (delta 2), reused 0 (delta 0)
remote: Resolving deltas: 100% (2/2), completed with 2 local objects.
To github.com:ruzickap/podinfo.git
   d4120e6..4d9f5bc  master -&gt; master
</code></pre></div><p>Wait for the pipelines to complete:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl <span class="token parameter variable">--timeout</span><span class="token operator">=</span>10m <span class="token parameter variable">-n</span> getting-started <span class="token function">wait</span> <span class="token parameter variable">--for</span><span class="token operator">=</span>condition<span class="token operator">=</span>Succeeded pipelineruns <span class="token parameter variable">--all</span>
<span class="token function">sleep</span> <span class="token number">5</span>
</code></pre></div><p>Output:</p> <div class="language-text extra-class"><pre class="language-text"><code>pipelinerun.tekton.dev/getting-started-pipeline-run-dzqdl condition met
pipelinerun.tekton.dev/getting-started-pipeline-run-fzrtg condition met
</code></pre></div><p>Check how the logs of the newly deployed podinfo logs should contain
&quot;Starting podinfo - new Tekton build version&quot;:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token assign-left variable">PODINFO_POD</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl get pods <span class="token parameter variable">-n</span> getting-started <span class="token parameter variable">-l</span><span class="token operator">=</span>run<span class="token operator">=</span>podinfo <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span>
kubectl <span class="token parameter variable">-n</span> getting-started delete pod <span class="token parameter variable">-n</span> getting-started <span class="token variable">${PODINFO_POD}</span>
<span class="token function">sleep</span> <span class="token number">5</span>
<span class="token assign-left variable">PODINFO_POD</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl get pods <span class="token parameter variable">-n</span> getting-started <span class="token parameter variable">-l</span><span class="token operator">=</span>run<span class="token operator">=</span>podinfo <span class="token parameter variable">-o</span> <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&quot;{.items[0].metadata.name}&quot;</span><span class="token variable">)</span></span>
kubectl <span class="token parameter variable">-n</span> getting-started logs <span class="token parameter variable">-n</span> getting-started <span class="token variable">${PODINFO_POD}</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>
</code></pre></div><p>Output:</p> <div class="language-json extra-class"><pre class="language-json"><code>pod <span class="token string">&quot;podinfo-6ccfb5f9b6-bwrbn&quot;</span> deleted
<span class="token punctuation">{</span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token string">&quot;2019-12-27T10:28:22.304Z&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;caller&quot;</span><span class="token operator">:</span><span class="token string">&quot;podinfo/main.go:120&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;Starting podinfo - new Tekton build version&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;version&quot;</span><span class="token operator">:</span><span class="token string">&quot;3.1.5&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;revision&quot;</span><span class="token operator">:</span><span class="token string">&quot;4d9f5bc71bd9a8c7ae44a9cd9631e45067727a2e&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;port&quot;</span><span class="token operator">:</span><span class="token string">&quot;9898&quot;</span><span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ruzickap/k8s-knative-gitlab-harbor/edit/master/docs/part-08/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/30/2024, 4:11:02 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      
      <a href="/k8s-knative-gitlab-harbor/part-07/" class="prev">
        Build and run container image using Knative + Tekton
      </a></span> <span class="next"><a href="/k8s-knative-gitlab-harbor/part-09/">
        Knative operations
      </a>
      
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/k8s-knative-gitlab-harbor/assets/js/app.e9f46d57.js" defer></script><script src="/k8s-knative-gitlab-harbor/assets/js/2.99da59a7.js" defer></script><script src="/k8s-knative-gitlab-harbor/assets/js/1.416be298.js" defer></script><script src="/k8s-knative-gitlab-harbor/assets/js/22.8f730d8b.js" defer></script>
  </body>
</html>
